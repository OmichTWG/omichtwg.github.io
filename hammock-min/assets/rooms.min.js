"use strict";const __rooms=[];let currentRoom,__roomsFlat=[];const onTileMapLoaded=(e,t)=>{__rooms.push({layers:t.layers,tileheight:t.tileheight,tilewidth:t.tilewidth,width:t.width,height:t.height,...__roomsFlat.find((t=>e===t.name))})},goToRoom=e=>{__instances=[],camera.x=0,camera.y=0,camera.scaleX=1,camera.scaleY=1;const t=__rooms.find((t=>t.name===e));if(t){const e={h:t.tileheight,w:t.tilewidth};currentRoom={name:t.name,w:t.width*e.w,h:t.height*e.h};let o=0;t.layers.forEach((i=>{switch(i.type){case"objectgroup":i.objects.forEach((e=>{const t={};e.properties&&e.properties.forEach((e=>t[e.name]=e.value));const o=instanceCreate(e.name,e.x,e.y,void 0,t);e.point||(o.sprite&&o.sprite.length&&(o.tpX=0,o.tpY=0,o.scaleX=e.width/o.sprite[0].width,o.scaleY=e.height/o.sprite[0].height),o.collider={type:"box",x1:0,y1:0,x2:e.width,y2:e.height,rotation:e.rotation})}));break;case"tilelayer":const a=__tiles.get(t.tileLayers[o][0]),r=[];let h=0,s=0;i.data.forEach((t=>{if(h>=i.width*e.w&&(h=0,s+=e.h),0!==t){const o=(t-1)*e.w%a.width,i=Math.floor((t-1)*e.w/a.width)*e.h;r.push({x:h,y:s,tx:o,ty:i})}h+=e.w})),__instanceCreateObj({name:`__tileLayer${o}`,tile:a,tiles:r,tileSize:e,depth:t.tileLayers[o][1]}),o++}}))}else console.error(`Нет комнаты с именем "${e}"`)},roomRestart=()=>{goToRoom(currentRoom.name)};